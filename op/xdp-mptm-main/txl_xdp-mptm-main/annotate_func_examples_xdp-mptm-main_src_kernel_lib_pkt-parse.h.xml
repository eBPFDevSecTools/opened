<?xml version="1.0"?>
<doc>
<source file="/home/sayandes/opened_extraction/examples/xdp-mptm-main/src/kernel/lib/pkt-parse.h" funcheader="static __ALWAYS_INLINE__ int parse_pkt_headers (void *data, void *data_end, struct ethhdr **ethhdr, struct iphdr **iphdr, struct udphdr **udphdr)" startline="41" endline="97">
static __ALWAYS_INLINE__ int parse_pkt_headers (void *data, void *data_end, struct ethhdr **ethhdr, struct iphdr **iphdr, struct udphdr **udphdr)
{
    struct hdr_cursor nh;
    int nh_type;
    nh.pos = data;
    if (ethhdr == NULL)
        return 0;
    struct ethhdr *eth;
    nh_type = parse_ethhdr (& nh, data_end, & eth);
    if (nh_type == -1)
        goto out_fail;
    if (eth->h_proto == BE_ETH_P_ARP)
        goto out_fail;
    if (eth->h_proto != BE_ETH_P_IP)
        goto out_fail;
    *ethhdr = eth;
    if (iphdr == NULL)
        return 0;
    struct iphdr *ip;
    nh_type = parse_iphdr (& nh, data_end, & ip);
    if (nh_type == -1)
        goto out_fail;
    *iphdr = ip;
    if (udphdr == NULL)
        return 0;
    struct udphdr *udp;
    if (nh_type == IPPROTO_TCP)
        goto out_fail;
    nh_type = parse_udphdr (& nh, data_end, & udp);
    if (nh_type == -1)
        goto out_fail;
    *udphdr = udp;
    return 0;
out_fail :
    return 1;
}
</source>
</doc>
