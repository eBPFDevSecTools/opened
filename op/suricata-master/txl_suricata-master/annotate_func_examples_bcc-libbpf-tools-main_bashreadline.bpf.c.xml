<?xml version="1.0"?>
<doc>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/bashreadline.bpf.c" funcheader="int BPF_KRETPROBE (printret, const void *ret)" startline="17" endline="36">
int BPF_KRETPROBE (printret, const void *ret)
{
    struct str_t data;
    char comm [TASK_COMM_LEN];
    u32 pid;
    if (!ret)
        return 0;
    bpf_get_current_comm (&comm, sizeof (comm));
    if (comm[0] != 'b' || comm[1] != 'a' || comm[2] != 's' || comm[3] != 'h' || comm[4] != 0)
        return 0;
    pid = bpf_get_current_pid_tgid () >> 32;
    data.pid = pid;
    bpf_probe_read_user_str (&data.str, sizeof (data.str), ret);
    bpf_perf_event_output (ctx, &events, BPF_F_CURRENT_CPU, &data, sizeof (data));
    return 0;
}
</source>
</doc>
