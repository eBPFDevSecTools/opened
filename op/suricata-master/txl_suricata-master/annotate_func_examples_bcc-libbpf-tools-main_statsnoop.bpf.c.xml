<?xml version="1.0"?>
<doc>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="static int probe_entry (void *ctx, const char *pathname)" startline="26" endline="40">
static int probe_entry (void *ctx, const char *pathname)
{
    __u64 id = bpf_get_current_pid_tgid ();
    __u32 pid = id >> 32;
    __u32 tid = (__u32) id;
    if (!pathname)
        return 0;
    if (target_pid && target_pid != pid)
        return 0;
    bpf_map_update_elem (&values, &tid, &pathname, BPF_ANY);
    return 0;
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="static int probe_return (void *ctx, int ret)" startline="42" endline="68">
static int probe_return (void *ctx, int ret)
{
    __u64 id = bpf_get_current_pid_tgid ();
    __u32 pid = id >> 32;
    __u32 tid = (__u32) id;
    const char **pathname;
    struct event event = {}
    ;
    pathname = bpf_map_lookup_elem (& values, & tid);
    if (!pathname)
        return 0;
    if (trace_failed_only && ret >= 0) {
        bpf_map_delete_elem (&values, &tid);
        return 0;
    }
    event.pid = pid;
    event.ts_ns = bpf_ktime_get_ns ();
    event.ret = ret;
    bpf_get_current_comm (&event.comm, sizeof (event.comm));
    bpf_probe_read_user_str (event.pathname, sizeof (event.pathname), *pathname);
    bpf_perf_event_output (ctx, &events, BPF_F_CURRENT_CPU, &event, sizeof (event));
    bpf_map_delete_elem (&values, &tid);
    return 0;
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_statfs_entry (struct trace_event_raw_sys_enter *ctx)" startline="71" endline="74">
int handle_statfs_entry (struct trace_event_raw_sys_enter *ctx)
{
    return probe_entry (ctx, (const char *) ctx->args[0]);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_statfs_return (struct trace_event_raw_sys_exit *ctx)" startline="77" endline="80">
int handle_statfs_return (struct trace_event_raw_sys_exit *ctx)
{
    return probe_return (ctx, (int) ctx->ret);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_newstat_entry (struct trace_event_raw_sys_enter *ctx)" startline="83" endline="86">
int handle_newstat_entry (struct trace_event_raw_sys_enter *ctx)
{
    return probe_entry (ctx, (const char *) ctx->args[0]);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_newstat_return (struct trace_event_raw_sys_exit *ctx)" startline="89" endline="92">
int handle_newstat_return (struct trace_event_raw_sys_exit *ctx)
{
    return probe_return (ctx, (int) ctx->ret);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_statx_entry (struct trace_event_raw_sys_enter *ctx)" startline="95" endline="98">
int handle_statx_entry (struct trace_event_raw_sys_enter *ctx)
{
    return probe_entry (ctx, (const char *) ctx->args[1]);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_statx_return (struct trace_event_raw_sys_exit *ctx)" startline="101" endline="104">
int handle_statx_return (struct trace_event_raw_sys_exit *ctx)
{
    return probe_return (ctx, (int) ctx->ret);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_newfstatat_entry (struct trace_event_raw_sys_enter *ctx)" startline="107" endline="110">
int handle_newfstatat_entry (struct trace_event_raw_sys_enter *ctx)
{
    return probe_entry (ctx, (const char *) ctx->args[1]);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_newfstatat_return (struct trace_event_raw_sys_exit *ctx)" startline="113" endline="116">
int handle_newfstatat_return (struct trace_event_raw_sys_exit *ctx)
{
    return probe_return (ctx, (int) ctx->ret);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_newlstat_entry (struct trace_event_raw_sys_enter *ctx)" startline="119" endline="122">
int handle_newlstat_entry (struct trace_event_raw_sys_enter *ctx)
{
    return probe_entry (ctx, (const char *) ctx->args[0]);
}
</source>
<source file="/home/sayandes/opened_extraction/examples/bcc-libbpf-tools-main/statsnoop.bpf.c" funcheader="int handle_newlstat_return (struct trace_event_raw_sys_exit *ctx)" startline="125" endline="128">
int handle_newlstat_return (struct trace_event_raw_sys_exit *ctx)
{
    return probe_return (ctx, (int) ctx->ret);
}
</source>
</doc>
