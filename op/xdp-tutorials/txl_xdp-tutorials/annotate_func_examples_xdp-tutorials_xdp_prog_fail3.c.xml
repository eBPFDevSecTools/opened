<?xml version="1.0"?>
<doc>
<source file="/root/examples/xdp-tutorials/xdp_prog_fail3.c" funcheader="int _xdp_fail3 (struct xdp_md *ctx)" startline="21" endline="55">
int _xdp_fail3 (struct xdp_md *ctx)
{
    void *data_end = (void *) (long) ctx->data_end;
    void *data = (void *) (long) ctx->data;
    unsigned char *ptr;
    __u64 offset = data_end - data;
    offset = offset & MAX_PACKET_OFF;
    if (offset < 2)
        offset = 2;
    if (data + offset > data_end)
        goto out;
    ptr = data + (offset - sizeof (*ptr));
    if (*ptr == 0xFF)
        return XDP_ABORTED;
out :
    return XDP_PASS;
}
</source>
</doc>
