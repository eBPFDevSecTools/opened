<?xml version="1.0"?>
<doc>
<source file="/root/examples/xdp-tutorials/xdp_prog_kern3.c" funcheader="int _xdp_works1 (struct xdp_md *ctx)" startline="15" endline="56">
int _xdp_works1 (struct xdp_md *ctx)
{
    void *data_end = (void *) (long) ctx->data_end;
    void *data = (void *) (long) ctx->data;
    unsigned char *ptr;
    void *pos;
    unsigned int offset = data_end - data;
    barrier_var (offset);
    offset = offset - 1;
    offset &= 0x7FFF;
    pos = data;
    pos += offset;
    if (pos + 1 > data_end)
        return XDP_DROP;
    ptr = pos;
    if (*ptr == 0xFF)
        return XDP_ABORTED;
    return XDP_PASS;
}
</source>
</doc>
