<?xml version="1.0"?>
<doc>
<source file="/root/examples/xdp-tutorials/af_xdp_kern.c" funcheader="int xdp_sock_prog (struct xdp_md *ctx)" startline="22" endline="41">
int xdp_sock_prog (struct xdp_md *ctx)
{
    int index = ctx->rx_queue_index;
    __u32 *pkt_count;
    pkt_count = bpf_map_lookup_elem (& xdp_stats_map, & index);
    if (pkt_count) {
        if ((*pkt_count)++ & 1)
            return XDP_PASS;
    }
    if (bpf_map_lookup_elem (&xsks_map, &index))
        return bpf_redirect_map (&xsks_map, index, 0);
    return XDP_PASS;
}
</source>
</doc>
