<?xml version="1.0"?>
<doc>
<source file="/root/examples/xdp-tutorials/xdp_prog_fail1.c" funcheader="int _xdp_fail1 (struct xdp_md *ctx)" startline="14" endline="46">
int _xdp_fail1 (struct xdp_md *ctx)
{
    void *data_end = (void *) (long) ctx->data_end;
    void *data = (void *) (long) ctx->data;
    unsigned char *ptr;
    void *pos;
    unsigned int offset = data_end - data;
    pos = data;
    if (pos + offset > data_end)
        goto out;
    ptr = pos + (offset - sizeof (*ptr));
    if (*ptr == 0xFF)
        return XDP_ABORTED;
out :
    return XDP_PASS;
}
</source>
</doc>
