<?xml version="1.0"?>
<doc>
<source file="/root/examples/bcc/mysqld_query.c" funcheader="int do_trace (struct pt_regs *ctx)" startline="2" endline="15">
int do_trace (struct pt_regs *ctx)
{
    uint64_t addr;
    char query [128];
    bpf_usdt_readarg (1, ctx, &addr);
    bpf_probe_read_user (&query, sizeof (query), (void *) addr);
    bpf_trace_printk ("%s\\n", query);
    return 0;
}
</source>
</doc>
