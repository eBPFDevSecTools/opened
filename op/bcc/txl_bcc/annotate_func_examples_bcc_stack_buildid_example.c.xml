<?xml version="1.0"?>
<doc>
<source file="/root/examples/bcc/stack_buildid_example.c" funcheader="int do_perf_event (struct bpf_perf_event_data *ctx)" startline="13" endline="26">
int do_perf_event (struct bpf_perf_event_data *ctx)
{
    u32 pid = bpf_get_current_pid_tgid () >> 32;
    struct key_t key = {
        .pid = pid}
    ;
    bpf_get_current_comm (&key.name, sizeof (key.name));
    key.user_stack_id = stack_traces.get_stackid (&ctx->regs, BPF_F_USER_STACK);
    if (key.user_stack_id >= 0) {
        counts.increment (key);
    }
    return 0;
}
</source>
</doc>
