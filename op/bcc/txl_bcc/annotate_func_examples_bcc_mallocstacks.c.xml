<?xml version="1.0"?>
<doc>
<source file="/root/examples/bcc/mallocstacks.c" funcheader="int alloc_enter (struct pt_regs *ctx, size_t size)" startline="6" endline="18">
int alloc_enter (struct pt_regs *ctx, size_t size)
{
    int key = stack_traces.get_stackid (ctx, BPF_F_USER_STACK);
    if (key < 0)
        return 0;
    u64 zero = 0, *val;
    val = calls.lookup_or_try_init (&key, &zero);
    if (val) {
        (*val) += size;
    }
    return 0;
}
</source>
</doc>
