<?xml version="1.0"?>
<doc>
<source file="/root/examples/bcc/strlen_count.c" funcheader="int count (struct pt_regs *ctx)" startline="8" endline="22">
int count (struct pt_regs *ctx)
{
    if (!PT_REGS_PARM1(ctx))
        return 0;
    struct key_t key = {}
    ;
    u64 zero = 0, *val;
    bpf_probe_read_user (&key.c, sizeof (key.c), (void *) PT_REGS_PARM1 (ctx));
    val = counts.lookup_or_try_init (&key, &zero);
    if (val) {
        (*val)++;
    }
    return 0;
}
</source>
</doc>
