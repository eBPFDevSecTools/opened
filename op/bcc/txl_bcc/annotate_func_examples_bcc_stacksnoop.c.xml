<?xml version="1.0"?>
<doc>
<source file="/root/examples/bcc/stacksnoop.c" funcheader="void trace_stack (struct pt_regs *ctx)" startline="13" endline="21">
void trace_stack (struct pt_regs *ctx)
{
    u32 pid = bpf_get_current_pid_tgid () >> 32;
    FILTER struct data_t data = {}
    ;
    data.stack_id = stack_traces.get_stackid (ctx, 0), data.pid = pid;
    bpf_get_current_comm (&data.comm, sizeof (data.comm));
    events.perf_submit (ctx, &data, sizeof (data));
}
</source>
</doc>
