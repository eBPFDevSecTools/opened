<?xml version="1.0"?>
<doc>
<source file="/root/examples/bcc/strlen_snoop.c" funcheader="int printarg (struct pt_regs *ctx)" startline="2" endline="15">
int printarg (struct pt_regs *ctx)
{
    if (!PT_REGS_PARM1(ctx))
        return 0;
    u32 pid = bpf_get_current_pid_tgid ();
    if (pid != PID)
        return 0;
    char str [80] = {};
    bpf_probe_read_user (&str, sizeof (str), (void *) PT_REGS_PARM1 (ctx));
    bpf_trace_printk ("%s\\n", &str);
    return 0;
}
</source>
</doc>
